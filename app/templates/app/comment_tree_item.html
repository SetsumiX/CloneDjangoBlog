{% load custom_filters %}

<div class="card mb-2" style="margin-inline-start: {{level|mul:20}}px;">
    <div class="card-body">
        <!-- Аватар автора + -->
            <div class="d-flex align-items-center mb-2">
                {% if post.author.profile.avatar %}
                    <img src="{{ post.author.profile.avatar.url }}" alt="Картинка профиля {{ post.author.username }}" class="rounded-circle me-2" style="width: 30px; height: 30px;">
                {% else %}
                    <img src="https://99px.ru/sstorage/1/2021/11/image_13011211933406044080.gif" alt="Картинка профиля {{ post.author.username }}" class="rounded-circle me-2" style="width: 30px; height: 30px;">
                {% endif %}
                <div class="flex-grow-1">
                    <h6 class="card-subtitle mb-1 text-muted">
                        <strong style="font-size: 20px;">{{ comment.author.username }}</strong> <small class="text-muted" style="font-size: 12px;">({{comment.create_at|date:"d M Y H:i"}})</small>
                    </h6>
                    <p class="card-text">{{comment.content}}</p>
                    {% if user.is_authenticated %}
                        <button class="btn btn-sm btn-outline-secondary reply-btn" data-comment-id="{{comment.id}}">Ответить</button>
                    {% endif %}
                </div>
            </div>
        <!-- Аватар автора - -->
    </div>
</div>

{% for reply_item in replies %}
    {% include 'app/comment_tree_item.html' with comment=reply_item.comment replies=reply_item.replies level=level|add:1 %}
{% endfor %}
